/**
* First attempt to provide some native functionality to deskshell applications (windows)
*/

fs = require("fs");

module.exports.filePicker = function(params, back) {
	var exec = require('child_process').exec;
	var out = __dirname+'\\out.'+Math.random().toString().substring(3)+'.txt';
	fpicker = exec(__dirname+'\\winfunc.exe /fn filePicker /out '+out);

	fpicker.on('close', function (code) {
	  	fs.readFile(out, 'utf8', function(err, data) {
			if (err) throw err;
			fs.unlink(out);
			back(data);
		});
	});
}